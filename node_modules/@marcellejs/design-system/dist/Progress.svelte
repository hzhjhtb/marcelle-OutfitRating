<script>export let progress;
export let type = 'default';
export let thin = false;
</script>

<div
  class="progress-line"
  style={progress >= 0 ? `--bar-mr: ${100 - Math.floor(progress * 100)}%;` : '--bar-mr: 0px'}
  class:thin
  class:indeterminate={progress === undefined || progress === null || progress < 0}
  class:gray={type === 'idle'}
  class:green={type === 'success'}
  class:red={type === 'danger'}
/>

<style>
  .progress-line, 
  .progress-line:before {
    margin-top: 0.5rem;
    margin-bottom: 0.5rem;
    height: 0.5rem;
    width: 100%;
    overflow: hidden;
    border-radius: 0.25rem;
    font-size: 0.75rem;
    line-height: 1rem;
}

  .progress-line.thin, 
  .progress-line.thin:before {
    margin-top: 0.25rem;
    margin-bottom: 0.25rem;
    height: 0.25rem;
}

  .progress-line {
    display: flex;
    --tw-bg-opacity: 1;
    background-color: rgb(186 230 253 / var(--tw-bg-opacity));
}

  .progress-line:before, 
  .progress-line.thin:before {
    margin-top: 0px;
    margin-left: 0px;
    --tw-bg-opacity: 1;
    background-color: rgb(14 165 233 / var(--tw-bg-opacity));
    --tw-shadow: 0 0 #0000;
    --tw-shadow-colored: 0 0 #0000;
    box-shadow: var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow);
    content: '';
    margin-right: var(--bar-mr);
}

  .gray {
    --tw-bg-opacity: 1;
    background-color: rgb(229 231 235 / var(--tw-bg-opacity));
    --tw-text-opacity: 1;
    color: rgb(75 85 99 / var(--tw-text-opacity));
}
  .progress-line.gray:before {
    --tw-bg-opacity: 1;
    background-color: rgb(107 114 128 / var(--tw-bg-opacity));
}

  .green {
    --tw-bg-opacity: 1;
    background-color: rgb(167 243 208 / var(--tw-bg-opacity));
    --tw-text-opacity: 1;
    color: rgb(5 150 105 / var(--tw-text-opacity));
}
  .progress-line.green:before {
    --tw-bg-opacity: 1;
    background-color: rgb(16 185 129 / var(--tw-bg-opacity));
}

  .red {
    --tw-bg-opacity: 1;
    background-color: rgb(254 205 211 / var(--tw-bg-opacity));
    --tw-text-opacity: 1;
    color: rgb(225 29 72 / var(--tw-text-opacity));
}
  .progress-line.red:before {
    --tw-bg-opacity: 1;
    background-color: rgb(244 63 94 / var(--tw-bg-opacity));
}

  .progress-line.indeterminate:before {
    animation: running-progress 2s cubic-bezier(0.4, 0, 0.2, 1) infinite;
  }
  @keyframes running-progress {
    0% {
      margin-left: 0px;
      margin-right: 100%;
    }
    50% {
      margin-left: 25%;
      margin-right: 0%;
    }
    100% {
      margin-left: 100%;
      margin-right: 0;
    }
  }</style>
