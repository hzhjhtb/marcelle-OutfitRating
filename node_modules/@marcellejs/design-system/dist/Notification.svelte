<script>import { blur } from 'svelte/transition';
import { flip } from 'svelte/animate';
export let notifications = [];
function close(id) {
    notifications = notifications.filter((x) => x.id !== id);
}
let uid = 1;
export function add({ title, message, type = 'default', duration = 3000 }) {
    const n = {
        id: uid,
        title,
        message,
        type
    };
    uid += 1;
    notifications = [...notifications, n];
    if (duration > 0) {
        setTimeout(() => {
            close(n.id);
        }, duration);
    }
}
</script>

<div class="marcelle notification-container">
	{#each notifications.slice(0, 10) as { title, message, type, id } (id)}
		<div
			transition:blur={{ amount: 10 }}
			animate:flip
			class="notification-card"
			role="alert"
			class:default={type === 'default'}
			class:danger={type === 'danger'}
		>
			<div class="flex items-start">
				<div class="py-1">
					<svg
						class="notification-svg mr-4"
						class:default={type === 'default'}
						class:danger={type === 'danger'}
						xmlns="http://www.w3.org/2000/svg"
						viewBox="0 0 20 20"
					>
						{#if type === 'default'}
							<path
								d="M2.93 17.07A10 10 0 1 1 17.07 2.93 10 10 0 0 1 2.93 17.07zm12.73-1.41A8 8 0 1 0
                4.34 4.34a8 8 0 0 0 11.32 11.32zM9 11V9h2v6H9v-4zm0-6h2v2H9V5z"
							/>
						{:else if type === 'danger'}
							<path
								d="M2.93 17.07A10 10 0 1 1 17.07 2.93 10 10 0 0 1 2.93 17.07zm12.73-1.41A8 8 0 1 0
                4.34 4.34a8 8 0 0 0 11.32 11.32zM9 5h2v6H9V5zm0 8h2v2H9v-2z"
							/>
						{/if}
					</svg>
				</div>
				<div>
					<p class="my-1 font-bold">{title}</p>
					<p class="my-1 text-sm">{message}</p>
				</div>
				<!-- <span class="absolute top-0 bottom-0 right-0 px-4 py-3"> -->
				<div>
					<svg
						class="notification-svg ml-4 cursor-pointer"
						class:default={type === 'default'}
						class:danger={type === 'danger'}
						on:click={() => close(id)}
						role="button"
						xmlns="http://www.w3.org/2000/svg"
						viewBox="0 0 20 20"
					>
						<title>Close</title>
						<path
							d="M14.348 14.849a1.2 1.2 0 0 1-1.697 0L10 11.819l-2.651 3.029a1.2 1.2 0 1
              1-1.697-1.697l2.758-3.15-2.759-3.152a1.2 1.2 0 1 1 1.697-1.697L10
              8.183l2.651-3.031a1.2 1.2 0 1 1 1.697 1.697l-2.758 3.152 2.758 3.15a1.2 1.2 0 0 1 0
              1.698z"
						/>
					</svg>
				</div>
			</div>
		</div>
	{/each}
</div>

<style>
	.notification-container {

    position: fixed;

    top: 0px;

    right: 0px;

    z-index: 20;

    margin: 0.5rem;

    display: flex;

    max-width: 28rem;

    flex-direction: column;

    align-items: flex-end;

    justify-content: flex-end
}

	.notification-card {

    margin-top: 0.5rem;

    width: auto;

    border-radius: 0.5rem;

    border-top-width: 4px;

    padding-left: 1rem;

    padding-right: 1rem;

    padding-top: 0.75rem;

    padding-bottom: 0.75rem;

    --tw-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);

    --tw-shadow-colored: 0 4px 6px -1px var(--tw-shadow-color), 0 2px 4px -2px var(--tw-shadow-color);

    box-shadow: var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)
}

	.notification-card.default {

    --tw-border-opacity: 1;

    border-color: rgb(20 184 166 / var(--tw-border-opacity));

    --tw-bg-opacity: 1;

    background-color: rgb(204 251 241 / var(--tw-bg-opacity));

    --tw-text-opacity: 1;

    color: rgb(19 78 74 / var(--tw-text-opacity))
}

	.notification-card.danger {

    --tw-border-opacity: 1;

    border-color: rgb(244 63 94 / var(--tw-border-opacity));

    --tw-bg-opacity: 1;

    background-color: rgb(255 228 230 / var(--tw-bg-opacity));

    --tw-text-opacity: 1;

    color: rgb(136 19 55 / var(--tw-text-opacity))
}

	.notification-svg {

    height: 1.5rem;

    width: 1.5rem;

    fill: currentColor
}

	.notification-svg.default {

    --tw-text-opacity: 1;

    color: rgb(20 184 166 / var(--tw-text-opacity))
}

	.notification-svg.danger {

    --tw-text-opacity: 1;

    color: rgb(244 63 94 / var(--tw-text-opacity))
}</style>
